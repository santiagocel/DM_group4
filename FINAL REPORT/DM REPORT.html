<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DM Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="DM REPORT_files/libs/clipboard/clipboard.min.js"></script>
<script src="DM REPORT_files/libs/quarto-html/quarto.js"></script>
<script src="DM REPORT_files/libs/quarto-html/popper.min.js"></script>
<script src="DM REPORT_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="DM REPORT_files/libs/quarto-html/anchor.min.js"></script>
<link href="DM REPORT_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="DM REPORT_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="DM REPORT_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="DM REPORT_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="DM REPORT_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DM Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">1. Introduction</h2>
<p>E-Commerce websites have become a popular strategy for many businesses to seamlessly market and sell their products to customers. It is crucial that these websites operate smoothly to captivate more customers and attain competitive advantage and the platforms are heavily reliant on proper data management. This report discusses in detail the data management aspects of “We-Buy” a simulated E-Commerce environment from database design to analysis and reporting.</p>
</section>
<section id="database-design-and-implementation" class="level2">
<h2 class="anchored" data-anchor-id="database-design-and-implementation">2. Database Design and Implementation</h2>
<p>The Mini world of E-Commerce is a digitized platform where customers with an online profile can view and buy products online. The products will be sold by designated sellers and dispatched and distributed to the customers when they make a purchase and complete payment. &nbsp;</p>
<section id="requirement-collection-and-analysis" class="level3">
<h3 class="anchored" data-anchor-id="requirement-collection-and-analysis"><strong>2.1. Requirement Collection and Analysis</strong> &nbsp;</h3>
<section id="assumptions-for-er-diagram" class="level4">
<h4 class="anchored" data-anchor-id="assumptions-for-er-diagram"><strong>2.1.1.</strong> Assumptions for ER Diagram&nbsp;</h4>
<p>Customer:&nbsp;</p>
<ul>
<li><p>One customer must have at least one address and multiple orders can be delivered to one address.&nbsp;&nbsp;</p></li>
<li><p>The email of customers must be unique.&nbsp;</p></li>
</ul>
<p>Orders:&nbsp;</p>
<ul>
<li><p>One order can have multiple products.&nbsp;&nbsp;</p></li>
<li><p>The ‘sub_quantity’ in the order details shows the number of each product separately.&nbsp;&nbsp;</p></li>
<li><p>If an order is delivered, then it has only 1 transaction.&nbsp;</p></li>
</ul>
<p>Transaction:&nbsp;</p>
<ul>
<li><p>One transaction match with one delivery.&nbsp;&nbsp;</p></li>
<li><p>Meanwhile, if the order status is ‘Pending’,’ Processing’ or ‘Cancelled’, there is no transaction matched with it. If the order status is ‘Succeed’, it matches with one transaction record. &nbsp;</p></li>
<li><p>Every transaction can have multiple products.&nbsp;</p></li>
</ul>
<p>Delivery:&nbsp;</p>
<ul>
<li><p>One delivery matches one customer address at one time.&nbsp;</p></li>
<li><p>One delivery can only be linked with one transaction at a time. Also, If the transaction status is ‘Pending’,’ Processing’ or ‘Cancelled’, there is no delivery. If the transaction status is ‘Succeed’, it matches with one delivery record. &nbsp;</p></li>
</ul>
<p>Product:&nbsp;</p>
<ul>
<li><p>One product belongs to one category.&nbsp;</p></li>
<li><p>One product can be supplied by multiple suppliers.&nbsp;</p></li>
<li><p>One product can have 0 or 1 or many advertisements.&nbsp;</p></li>
<li><p>One product can be in multiple transactions and multiple orders.&nbsp;</p></li>
<li><p>The rate value is between 0 to 5.&nbsp;</p></li>
</ul>
<p>Category:&nbsp;</p>
<ul>
<li><p>One category can have many products.&nbsp;</p></li>
<li><p>One parent category can have multiple sub-categories.&nbsp;</p></li>
</ul>
<p>Supply:&nbsp;</p>
<ul>
<li><p>This is a relationship between suppliers and products.&nbsp;</p></li>
<li><p>Stock cannot be empty.&nbsp;</p></li>
</ul>
<p>Supplier:&nbsp;</p>
<ul>
<li><p>One supplier can supply multiple products.&nbsp;</p></li>
<li><p>The email of each supplier should be unique.&nbsp;</p></li>
</ul>
<p>Ads:&nbsp;</p>
<ul>
<li><p>One ad can only match one product.&nbsp;</p></li>
<li><p>If the ad is ‘active’ which means that the last day to show the ad is after today. If the ad is ‘ended’, it means that the last day was before today. All advertisements have a start date.&nbsp;&nbsp;</p></li>
</ul>
</section>
<section id="logic-design" class="level4">
<h4 class="anchored" data-anchor-id="logic-design"><strong>2.1.2. Logic Design</strong></h4>
<ul>
<li><p>customer (customer_id(PK), first_name, last_name, email, password_hash, gender, membership, date_of_birth, customer_address (zip_code, country, state, city, street))&nbsp;</p></li>
<li><p>order(order_id (PK), customer_id (FK), product_id(FK), order_date, order_status, order_details(sub_quantity))&nbsp;</p></li>
<li><p>transactions (transaction_id(PK), order_id(FK), customer_id(FK), transaction_time, transaction_status, payment_method)&nbsp;</p></li>
<li><p>delivery (delivery_id(PK), transaction_id(FK), customer_address_id(FK), delivery_start_sate, delivery_end_date, delivery_status)&nbsp;</p></li>
<li><p>product (product_id (PK), category_id(FK), product_price, product_name, discount_percentage, rate_value)&nbsp;</p></li>
<li><p>supply (supply_id(PK), supplier_id(FK), product_id(FK), stock)&nbsp;</p></li>
<li><p>supplier (supplier_id(PK), supplier_email, supplier_name, supplier_street, supplier_city, supplier_state, supplier_country, supplier_zip_code)&nbsp;</p></li>
<li><p>ads (ad_id(PK), product_id(FK), ad_start_date, ad_end_date, ad_status))&nbsp;</p></li>
<li><p>category (category_id(PK), parent_category_id(FK), category_type)</p></li>
</ul>
<p>&nbsp;&nbsp;</p>
</section>
<section id="data-relationships" class="level4">
<h4 class="anchored" data-anchor-id="data-relationships"><strong>2.2. Data Relationships</strong></h4>
<p><strong>One to One relationship</strong>&nbsp;</p>
<ul>
<li><p>Entity: Customer and Transaction&nbsp;</p></li>
<li><p>Relationship:&nbsp;A Customer can have only one transaction at a time, and one transaction will be entered in to by one customer.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image1.png" class="img-fluid figure-img"></p>
<figcaption>Customer - Transaction relationship</figcaption>
</figure>
</div></li>
<li><p>Entity: Transaction and Delivery&nbsp;</p></li>
<li><p>Relationship: A transaction will have one delivery, and each delivery will begin with one transaction</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image2.png" class="img-fluid figure-img"></p>
<figcaption>Transaction - Delivery relationship</figcaption>
</figure>
</div>
<p><strong>One to Many relationship</strong>&nbsp;</p></li>
<li><p>Entity: Transaction and Product &nbsp;</p></li>
<li><p>Relationship:&nbsp;Each transaction can have many products, but each product will only belong to one transaction&nbsp;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image3.png" class="img-fluid figure-img"></p>
<figcaption>Transaction - Product relationship</figcaption>
</figure>
</div></li>
<li><p>Entity: Product and Ads&nbsp;</p></li>
<li><p>Relationship: Each product can have many Ads, but each Ad will only belong to one product</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image4.png" class="img-fluid figure-img"></p>
<figcaption>Product - Ad relationship</figcaption>
</figure>
</div></li>
<li><p>Entity: Category and Product &nbsp;</p></li>
<li><p>Relationship:&nbsp;Each category will have many products, but each product will only belong to one category&nbsp;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image5.png" class="img-fluid figure-img"></p>
<figcaption>Category - Product relationship</figcaption>
</figure>
</div></li>
<li><p>Entity: Category and Category &nbsp;</p></li>
<li><p>Relationship: Each parent category will have many subcategories, but each subcategory will only belong to one parent category</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image6.png" class="img-fluid figure-img"></p>
<figcaption>Category - Category relationship</figcaption>
</figure>
</div>
<p><strong>Many to Many relationship</strong></p></li>
<li><p>Entity: Customer and Product &nbsp;</p></li>
<li><p>Relationship:&nbsp;A customer can have multiple products, and each product can be bought by multiple customers&nbsp;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images7.png" class="img-fluid figure-img"></p>
<figcaption>Customer - Product relationship</figcaption>
</figure>
</div></li>
<li><p>Entity: Product and Supplier &nbsp;</p></li>
<li><p>Relationship: A product can have many suppliers, and each supplier can have many products.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Screenshot%202024-03-17%20143912.png" class="img-fluid figure-img"></p>
<figcaption>Supplier - Product relationship</figcaption>
</figure>
</div></li>
</ul>
</section>
<section id="er-diagram-design" class="level4">
<h4 class="anchored" data-anchor-id="er-diagram-design">2.3. ER Diagram Design</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ER%20DIAGRAM%20FINAL.png" class="img-fluid figure-img"></p>
<figcaption>ER Diagram</figcaption>
</figure>
</div>
</section>
<section id="sql-database-design" class="level4">
<h4 class="anchored" data-anchor-id="sql-database-design">2.4. SQL Database Design</h4>
<p>The Figure 10 depicts theentity relationship diagramfor the database that includes various tables: Customer, Orders, Transactions, Delivery, Product, Ads, Supply, Supplier, and Category. These tables store information based on the relationship indicating how the customer details, orders, products, suppliers, and advertisements are linked to managing inventory, order processing, and customer interactions. This is done to ensure seamless flow from customer order to delivery.&nbsp;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="sql%20design.png" class="img-fluid figure-img" width="500"></p>
<figcaption>SQL design</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="data-generation-and-management" class="level2">
<h2 class="anchored" data-anchor-id="data-generation-and-management"><strong>3. Data generation and Management</strong></h2>
<section id="synthetic-data-generation" class="level3">
<h3 class="anchored" data-anchor-id="synthetic-data-generation"><strong>3.1. Synthetic Data generation</strong></h3>
<p>Data generation methods were tested through Mockaroo, ChatGPT and Python. Mockaroo was rejected as the platform allows very less customization and the generated data were inconsistent and irrelevant. ChatGPT was rejected as the system did not respond and could not handle the specifications mentioned with the amount of data required. Python proved to be a suitable platform to generate consistent and accurate data and could handle the specifications and validations given. Faker, pandas, datetime, OS and random libraries were imported to the environment for data generation. &nbsp;</p>
<p>Several assumptions were made when generating the data.</p>
<p>Customer: &nbsp;</p>
<p>Customer is an important part of the data. With the help of customer data, we will be able to do necessary analysis, but there are certain conditions that should be met while creating the data for the customer.&nbsp;</p>
<p>A customer must have at least one address and multiple orders can be delivered to one.&nbsp;&nbsp;</p>
<p>One feature that is inspired by real world e-commerce companies is membership. Based on the membership, customers get a variety of rewards. In the case of We-Buy, the company offers discounted prices.&nbsp;&nbsp;&nbsp;</p>
<p>Order:</p>
<p>As an e-commerce company, it is important to understand how people are utilizing the service and what all products are being bought. This helps the company to understand what all the products that generate maximum revenue for the company.&nbsp;&nbsp;</p>
<p>This data should contain specific information about the order submitted by the customer. Information such as order status and order date should be considered. Order status has different values such as ‘Pending’, ‘Processing’, ‘Cancelled’, ‘Submitted’, and ‘Succeed’. We must connect order data with customer information. So, customer id is also mentioned in this table so that while doing analysis, it is easy to retrieve information from customer table.&nbsp;&nbsp;</p>
<p>Supplier:</p>
<p>Suppliers play a vital role. The orders placed by customers are gone to suppliers. With this, suppliers can send the product to the respective customers. Hence suppliers are handling all the goods, it is important to store supplier information. So, geographical information such as address, and other contact information are collected and saved.&nbsp;&nbsp;</p>
<p>One assumption that is required for supplier is that one supplier can supply products to multiple customers.&nbsp;&nbsp;</p>
<p>To make sure that the customer gets the item, each supplier is required to note down the items available in stock. For this, product id is used to access the product table to get necessary information.&nbsp;&nbsp;</p>
<p>Product:</p>
<p>It is very important to capture information regarding the products. At the same time, there are several assumptions that are made to make sure that the data collected will help the company to deduce required information.&nbsp;&nbsp;</p>
<p>One product should be matched with one category, but at the same time, one category can have many products under it. So, it is important to make sure that the products are mapped accordingly.&nbsp;&nbsp;</p>
<p>It is also to be noted that ads can help with selling more products, but it is not mandatory that every product has ads. So, it is assumed that each product can have wide variety of ads or one or no ads. This information can help us understand whether ads will help to sell more products or not.&nbsp;&nbsp;</p>
<p>Delivery:</p>
<p>Since the products will be delivered to customers, it is sensible to capture the information regarding the delivery. This should include information such as delivery status, transaction id, and customer id.&nbsp;&nbsp;</p>
<p>There are few important assumptions that should be made while considering this information.&nbsp;&nbsp;</p>
<p>One major assumption is that if the difference between the delivery start date and delivery end date is 30 days, then the delivery is considered as failed. Both the delivery start date and delivery end date are spread across the last quarter of 2023 and first quarter of 2024.&nbsp;&nbsp;</p>
<p>Some of the other key points to note is regarding how the dates are allocated based on the delivery status.&nbsp;</p>
<table class="table">
<tbody>
<tr class="odd">
<td><strong>Status</strong>&nbsp;</td>
<td><strong>Start Date</strong>&nbsp;</td>
<td><strong>End Date</strong>&nbsp;</td>
</tr>
<tr class="even">
<td>Not Delivered&nbsp;</td>
<td>Empty&nbsp;</td>
<td>Empty&nbsp;</td>
</tr>
<tr class="odd">
<td>In Delivery&nbsp;</td>
<td>Not Empty&nbsp;</td>
<td>Empty&nbsp;</td>
</tr>
<tr class="even">
<td>Complete&nbsp;</td>
<td>Not Empty&nbsp;</td>
<td>Not Empty&nbsp;</td>
</tr>
<tr class="odd">
<td>Failed&nbsp;</td>
<td>Not Empty&nbsp;</td>
<td>Not Empty&nbsp;</td>
</tr>
</tbody>
</table>
</section>
<section id="data-import-and-quality-assurance" class="level3">
<h3 class="anchored" data-anchor-id="data-import-and-quality-assurance"><strong>3.2. Data import and Quality assurance</strong></h3>
<p>It is crucial to check the quality of the data after it is imported. Especially, in this case, the data generated is synthetic data. Hence, it is even more reason to make sure if the data is correct or not. We must make sure of some of the basic information when it comes to data quality. For example, if there are two tables and both are connected by a foreign key, we must make sure that the data for foreign keys are taken correctly from the corresponding table. &nbsp;<br>
Also, every data will have missing values and other factors that can affect the quality. Hence, it is required to check and rectify the data if there are any discrepancies.&nbsp;&nbsp;</p>
<p>In R, we use str() and summary() to identify if the structure and datatypes of the data provided are not having any issues.&nbsp;&nbsp;</p>
<section id="data-validation-rules" class="level4">
<h4 class="anchored" data-anchor-id="data-validation-rules">3.3. Data Validation Rules</h4>
<p>For data validation, it is necessary to follow a structure. As every table holds key information, we must make sure that the data is correctly present. Below are the steps that should be followed while doing data validation.&nbsp;</p>
<ul>
<li><p>We need to check the primary keys are unique for every table and make sure that the foreign keys are mapped correctly.&nbsp;&nbsp;</p></li>
<li><p>Next, we must check if there are NA values for the attributes mentioned in the schema.&nbsp;&nbsp;</p></li>
<li><p>There are several data types involved in the tables. So, verifying that the data generated matches the data type mentioned in the schema is a crucial step.&nbsp;&nbsp;</p></li>
<li><p>In the schema, for certain attributes, there are character limits mentioned. So, it is important to carry out checks to make sure that the character limits are not violated.&nbsp;</p></li>
<li><p>Now, there can be information in specific format, for example, email. Email is used for both customers and suppliers. So, we must check that the emails are in the correct format.&nbsp;&nbsp;</p></li>
<li><p>One of the important data when it comes to e-commerce business is date. Several entities have dates associated with it. So, it becomes a mandatory step to check all the date formats and make changes if there are any.&nbsp;&nbsp;</p></li>
<li><p>In some cases, we need to check for conditions, and populate data based on those conditions, for example, yes or no. So, based on the schema, we must check and populate corresponding data with minimal to no issues.&nbsp;&nbsp;</p></li>
<li><p>Email Validation: The email provided should have a valid email format (example@gmail.com)&nbsp;</p></li>
<li><p>Entry Validation: Quantities entered must be a whole number&nbsp;&nbsp;</p></li>
<li><p>Date Validation: Start date must always be before the end date&nbsp;</p></li>
<li><p>Key Validation: All tables should have a Primary Key, and foreign key as required. Data types and data length should be as specified in the database&nbsp;</p></li>
</ul>
<p>Business rules:&nbsp;</p>
<ul>
<li><p>Transactions with delivery start date and delivery end date more than 30 days will be failed&nbsp;</p></li>
<li><p>Only successful orders can match with transactions&nbsp;</p></li>
<li><p>Only successful transactions can match with delivery&nbsp; .</p></li>
</ul>
</section>
<section id="data-storage-and-retrieval" class="level4">
<h4 class="anchored" data-anchor-id="data-storage-and-retrieval"><strong>3.4 Data Storage and Retrieval</strong></h4>
<ul>
<li><p>Database structure: A relational database structure with tables, columns, primary and foreign key relationships. &nbsp;</p></li>
<li><p>Data access methods: CRUD operations to enable efficient data retrieval and manipulation&nbsp;</p></li>
<li><p>Indexing and Query performance: Frequently queried fields optimized to run efficiently</p></li>
</ul>
</section>
</section>
</section>
<section id="data-pipeline-generation" class="level2">
<h2 class="anchored" data-anchor-id="data-pipeline-generation"><strong>4. Data pipeline generation</strong></h2>
<section id="github-repository-and-workflow-setup" class="level3">
<h3 class="anchored" data-anchor-id="github-repository-and-workflow-setup"><strong>4.1 GitHub repository and workflow setup</strong></h3>
<p>A repository was created through GitHub to centrally locate all information required for the data management of We-Buy. The repository was connected with R and push and pull functions synchronizing data flows to and from the repository were tested manually. All other information related such as the csv files containing the tables of the e-commerce data set, database file, quarto file, E-R diagram was uploaded to the repository for ease of use where all the members have access to the repository. Here,the required information that was necessary for the analysis was consolidated.</p>
<p><strong>4.2 GitHub actions for continuous integration<br>
</strong>We use GitHub Actions as a fundamental tool to automate processes in our analysis. By creating a general workflow in our repository, we automate the process of validating and analyzing the information with which our analysis is built. Likewise, we program the workflow so that the processes are repeated every hour, which allows us to constantly monitor the quality of the information being handled. However, the generated code is automatically activated by any push or pull. Through GitHub actions we guarantee to have control over the changes that are made to the information and processes that are carried out. Attached to this report are the access details of our repository and the code used to run the workflow.</p>
</section>
</section>
<section id="data-analysis-and-reporting" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis-and-reporting">5.Data analysis and Reporting</h2>
<p>Initially, the database is created and connected. All tables are dropped to ensure there is no overlapping to maintain data integrity and organization. After the tables are dropped, new tables can be loaded and created, and the quality of the data is checked. The checked data is later written into the database and the database is checked.</p>
</section>
<section id="create-and-connect-database" class="level2">
<h2 class="anchored" data-anchor-id="create-and-connect-database">Create and Connect Database</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the tables to drop</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tables_to_drop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ads"</span>, <span class="st">"category"</span>, <span class="st">"customer_address"</span>, <span class="st">"customer"</span>,<span class="st">"delivery"</span>, <span class="st">"orders"</span>, <span class="st">"orders_details"</span>, <span class="st">"product"</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"supplier"</span>, <span class="st">"supply"</span>, <span class="st">"`transaction`"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect to the database</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>my_connection <span class="ot">&lt;-</span> RSQLite<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(),<span class="st">"/cloud/project/database/an_e_commerce.db"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop each table</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (table_name <span class="cf">in</span> tables_to_drop) {</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbExecute</span>(my_connection, <span class="fu">paste</span>(<span class="st">"DROP TABLE IF EXISTS"</span>, table_name))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># After dropping tables, you can proceed to create and load new tables</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>sql_commands <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"Schema.sql"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sql_cmd <span class="cf">in</span> sql_commands) {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbExecute</span>(my_connection, sql_cmd)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print error message without stopping the execution</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cat("Error occurred: ", conditionMessage(e), "\n")</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">Import Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ads <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/ads_data.csv'</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">ad_start_date =</span> <span class="st">"c"</span>, <span class="at">ad_end_date =</span> <span class="st">"c"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>category <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/category_data.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 25 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): category_id, category_name, parent_category_id

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>customer_address <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/customer_addresses_data.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 205 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (7): customer_address_id, customer_id, zip_code, country, state, city, s...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>customer <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/customers_data.csv'</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">date_of_birth =</span> <span class="st">"c"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>delivery <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/delivery_data.csv'</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">delivery_start_date =</span> <span class="st">"c"</span>, <span class="at">delivery_end_date =</span> <span class="st">"c"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>orders_details <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/order_details_data.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1111 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): order_detail_id, order_id, product_id
dbl (1): sub_quantity

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/orders_data.csv'</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">order_date =</span> <span class="st">"c"</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>product <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/product_data.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 500 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): product_id, category_id, product_name
dbl (3): product_price, discount_percentage, rate_value

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>supplier <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/supplier_data.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 80 Columns: 8
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (8): supplier_id, supplier_name, supplier_email, supplier_zip_code, supp...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>supply <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/supply_data.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 100 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): supply_id, supplier_id, product_id
dbl (1): stock

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>transaction <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'/cloud/project/ecommerce_data/transactions_data.csv'</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">transaction_time =</span> <span class="st">"c"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-quality-check-before-writing-into-database" class="level2">
<h2 class="anchored" data-anchor-id="data-quality-check-before-writing-into-database">Data Quality Check before writing into database</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ads</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ads) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [100 × 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ ad_id        : chr [1:100] "AD3411" "AD5591" "AD2023" "AD2393" ...
 $ product_id   : chr [1:100] "PR5955" "PR2980" "PR4455" "PR9243" ...
 $ ad_status    : chr [1:100] "active" "active" "active" "ended" ...
 $ ad_start_date: chr [1:100] "2023-09-04" "2023-12-04" "2023-06-18" "2023-08-04" ...
 $ ad_end_date  : chr [1:100] "2024-04-26" "2025-01-07" "2024-04-13" "2023-09-09" ...
 - attr(*, "spec")=
  .. cols(
  ..   ad_id = col_character(),
  ..   product_id = col_character(),
  ..   ad_status = col_character(),
  ..   ad_start_date = col_character(),
  ..   ad_end_date = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ads<span class="sc">$</span>ad_status <span class="ot">=</span> <span class="fu">as.factor</span>(ads<span class="sc">$</span>ad_status)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ads)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [100 × 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ ad_id        : chr [1:100] "AD3411" "AD5591" "AD2023" "AD2393" ...
 $ product_id   : chr [1:100] "PR5955" "PR2980" "PR4455" "PR9243" ...
 $ ad_status    : Factor w/ 2 levels "active","ended": 1 1 1 2 1 2 1 1 1 2 ...
 $ ad_start_date: chr [1:100] "2023-09-04" "2023-12-04" "2023-06-18" "2023-08-04" ...
 $ ad_end_date  : chr [1:100] "2024-04-26" "2025-01-07" "2024-04-13" "2023-09-09" ...
 - attr(*, "spec")=
  .. cols(
  ..   ad_id = col_character(),
  ..   product_id = col_character(),
  ..   ad_status = col_character(),
  ..   ad_start_date = col_character(),
  ..   ad_end_date = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ads)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    ad_id            product_id         ad_status  ad_start_date     
 Length:100         Length:100         active:45   Length:100        
 Class :character   Class :character   ended :55   Class :character  
 Mode  :character   Mode  :character               Mode  :character  
 ad_end_date       
 Length:100        
 Class :character  
 Mode  :character  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Category</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing value in parent_category_id is reasonable if category_id is parent_category_id itself</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [25 × 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ category_id       : chr [1:25] "CT1001" "CT1001-208" "CT1001-546" "CT1001-865" ...
 $ category_name     : chr [1:25] "Clothing" "Shirts" "Pants" "Dresses" ...
 $ parent_category_id: chr [1:25] NA "CT1001" "CT1001" "CT1001" ...
 - attr(*, "spec")=
  .. cols(
  ..   category_id = col_character(),
  ..   category_name = col_character(),
  ..   parent_category_id = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> category_id        category_name      parent_category_id
 Length:25          Length:25          Length:25         
 Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Customer_address</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(customer_address)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [205 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ customer_address_id: chr [1:205] "CA8785" "CA6746" "CA4295" "CA2484" ...
 $ customer_id        : chr [1:205] "CU3320" "CU3320" "CU3320" "CU8307" ...
 $ zip_code           : chr [1:205] "21639" "86282" "57281" "30961" ...
 $ country            : chr [1:205] "Greece" "Bosnia and Herzegovina" "Jersey" "Luxembourg" ...
 $ state              : chr [1:205] "Arizona" "Nebraska" "Washington" "West Virginia" ...
 $ city               : chr [1:205] "East Blakeborough" "East Emily" "New Douglas" "North Kevinburgh" ...
 $ street             : chr [1:205] "76218 Catherine Freeway" "2956 Christina Inlet" "7829 Erik Extension" "6383 Gillespie Ways" ...
 - attr(*, "spec")=
  .. cols(
  ..   customer_address_id = col_character(),
  ..   customer_id = col_character(),
  ..   zip_code = col_character(),
  ..   country = col_character(),
  ..   state = col_character(),
  ..   city = col_character(),
  ..   street = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>customer_address<span class="sc">$</span>country <span class="ot">=</span> <span class="fu">as.factor</span>(customer_address<span class="sc">$</span>country)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>customer_address<span class="sc">$</span>state <span class="ot">=</span> <span class="fu">as.factor</span>(customer_address<span class="sc">$</span>state)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>customer_address<span class="sc">$</span>city <span class="ot">=</span> <span class="fu">as.factor</span>(customer_address<span class="sc">$</span>city)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(customer_address)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [205 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ customer_address_id: chr [1:205] "CA8785" "CA6746" "CA4295" "CA2484" ...
 $ customer_id        : chr [1:205] "CU3320" "CU3320" "CU3320" "CU8307" ...
 $ zip_code           : chr [1:205] "21639" "86282" "57281" "30961" ...
 $ country            : Factor w/ 145 levels "Afghanistan",..: 53 16 71 82 125 28 57 26 62 128 ...
 $ state              : Factor w/ 49 levels "Alabama","Alaska",..: 3 27 46 47 18 30 24 16 11 45 ...
 $ city               : Factor w/ 203 levels "Aaronburgh","Adamburgh",..: 28 30 104 125 6 200 37 71 186 180 ...
 $ street             : chr [1:205] "76218 Catherine Freeway" "2956 Christina Inlet" "7829 Erik Extension" "6383 Gillespie Ways" ...
 - attr(*, "spec")=
  .. cols(
  ..   customer_address_id = col_character(),
  ..   customer_id = col_character(),
  ..   zip_code = col_character(),
  ..   country = col_character(),
  ..   state = col_character(),
  ..   city = col_character(),
  ..   street = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(customer_address)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> customer_address_id customer_id          zip_code        
 Length:205          Length:205         Length:205        
 Class :character    Class :character   Class :character  
 Mode  :character    Mode  :character   Mode  :character  
                                                          
                                                          
                                                          
                                                          
             country           state                 city    
 Barbados        :  4   New Jersey: 10   West Elizabeth:  2  
 French Polynesia:  4   Hawaii    :  8   West Vincent  :  2  
 Austria         :  3   Florida   :  7   Aaronburgh    :  1  
 Guernsey        :  3   Missouri  :  7   Adamburgh     :  1  
 Hungary         :  3   Tennessee :  7   Allenmouth    :  1  
 India           :  3   Utah      :  7   Andersonberg  :  1  
 (Other)         :185   (Other)   :159   (Other)       :197  
    street         
 Length:205        
 Class :character  
 Mode  :character  
                   
                   
                   
                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Customer</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(customer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [100 × 8] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ customer_id  : chr [1:100] "CU3320" "CU8307" "CU0170" "CU2873" ...
 $ first_name   : chr [1:100] "Brian" "Martin" "Kim" "Douglas" ...
 $ last_name    : chr [1:100] "Miller" "Christian" "Johns" "Tyler" ...
 $ gender       : chr [1:100] "female" "male" "female" "female" ...
 $ date_of_birth: chr [1:100] "1962-12-09" "1944-11-12" "1960-10-09" "1934-10-05" ...
 $ email        : chr [1:100] "robersonnancy@example.com" "ann32@example.org" "stewartshane@example.org" "qberry@example.com" ...
 $ password_hash: chr [1:100] "429b5dfe28a2710cee6b6ce1ffc456b8296bb1fe49df6dcb069737f6694c7043" "da7e994ae66d4ca648b1c6f6f5bc3be3be91551b4777146fd0398efcdc3c19af" "18c5bd20707ff750674da884cc13a039a2e8e9d3efe46d7f9e039b13e81ceab8" "013f9b5037a025dd4f1646e37da24050e860e98f0beb3402257afcc8be912a42" ...
 $ membership   : chr [1:100] "yes" "yes" "no" "yes" ...
 - attr(*, "spec")=
  .. cols(
  ..   customer_id = col_character(),
  ..   first_name = col_character(),
  ..   last_name = col_character(),
  ..   gender = col_character(),
  ..   date_of_birth = col_character(),
  ..   email = col_character(),
  ..   password_hash = col_character(),
  ..   membership = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>customer<span class="sc">$</span>gender <span class="ot">=</span> <span class="fu">as.factor</span>(customer<span class="sc">$</span>gender)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(customer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [100 × 8] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ customer_id  : chr [1:100] "CU3320" "CU8307" "CU0170" "CU2873" ...
 $ first_name   : chr [1:100] "Brian" "Martin" "Kim" "Douglas" ...
 $ last_name    : chr [1:100] "Miller" "Christian" "Johns" "Tyler" ...
 $ gender       : Factor w/ 3 levels "female","male",..: 1 2 1 1 2 3 3 1 1 1 ...
 $ date_of_birth: chr [1:100] "1962-12-09" "1944-11-12" "1960-10-09" "1934-10-05" ...
 $ email        : chr [1:100] "robersonnancy@example.com" "ann32@example.org" "stewartshane@example.org" "qberry@example.com" ...
 $ password_hash: chr [1:100] "429b5dfe28a2710cee6b6ce1ffc456b8296bb1fe49df6dcb069737f6694c7043" "da7e994ae66d4ca648b1c6f6f5bc3be3be91551b4777146fd0398efcdc3c19af" "18c5bd20707ff750674da884cc13a039a2e8e9d3efe46d7f9e039b13e81ceab8" "013f9b5037a025dd4f1646e37da24050e860e98f0beb3402257afcc8be912a42" ...
 $ membership   : chr [1:100] "yes" "yes" "no" "yes" ...
 - attr(*, "spec")=
  .. cols(
  ..   customer_id = col_character(),
  ..   first_name = col_character(),
  ..   last_name = col_character(),
  ..   gender = col_character(),
  ..   date_of_birth = col_character(),
  ..   email = col_character(),
  ..   password_hash = col_character(),
  ..   membership = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(customer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> customer_id         first_name         last_name            gender  
 Length:100         Length:100         Length:100         female:40  
 Class :character   Class :character   Class :character   male  :36  
 Mode  :character   Mode  :character   Mode  :character   other :24  
 date_of_birth         email           password_hash       membership       
 Length:100         Length:100         Length:100         Length:100        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delivery</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It's reasonable to have missing values for delivery_start_date and delivery_end_date in "Failed" and "Not_Delivered" delivery_status</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(delivery)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [10 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ delivery_id        : chr [1:10] "DE9143" "DE9770" "DE1870" "DE4792" ...
 $ transaction_id     : chr [1:10] "TR3416" "TR5378" "TR4534" "TR8649" ...
 $ customer_address_id: chr [1:10] "CA7294" "CA9915" "CA2167" "CA9655" ...
 $ delivery_status    : chr [1:10] "In_Delivery" "Completed" "Failed" "Completed" ...
 $ delivery_start_date: chr [1:10] "2023-09-22" "2024-02-25" "2023-11-22" "2023-09-02" ...
 $ delivery_end_date  : chr [1:10] NA "2024-03-12" "2023-12-22" "2023-09-04" ...
 - attr(*, "spec")=
  .. cols(
  ..   delivery_id = col_character(),
  ..   transaction_id = col_character(),
  ..   customer_address_id = col_character(),
  ..   delivery_status = col_character(),
  ..   delivery_start_date = col_character(),
  ..   delivery_end_date = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>delivery<span class="sc">$</span>delivery_status <span class="ot">=</span> <span class="fu">as.factor</span>(delivery<span class="sc">$</span>delivery_status)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(delivery)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [10 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ delivery_id        : chr [1:10] "DE9143" "DE9770" "DE1870" "DE4792" ...
 $ transaction_id     : chr [1:10] "TR3416" "TR5378" "TR4534" "TR8649" ...
 $ customer_address_id: chr [1:10] "CA7294" "CA9915" "CA2167" "CA9655" ...
 $ delivery_status    : Factor w/ 4 levels "Completed","Failed",..: 3 1 2 1 3 4 4 1 2 1
 $ delivery_start_date: chr [1:10] "2023-09-22" "2024-02-25" "2023-11-22" "2023-09-02" ...
 $ delivery_end_date  : chr [1:10] NA "2024-03-12" "2023-12-22" "2023-09-04" ...
 - attr(*, "spec")=
  .. cols(
  ..   delivery_id = col_character(),
  ..   transaction_id = col_character(),
  ..   customer_address_id = col_character(),
  ..   delivery_status = col_character(),
  ..   delivery_start_date = col_character(),
  ..   delivery_end_date = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(delivery)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> delivery_id        transaction_id     customer_address_id      delivery_status
 Length:10          Length:10          Length:10           Completed    :4     
 Class :character   Class :character   Class :character    Failed       :2     
 Mode  :character   Mode  :character   Mode  :character    In_Delivery  :2     
                                                           Not_Delivered:2     
 delivery_start_date delivery_end_date 
 Length:10           Length:10         
 Class :character    Class :character  
 Mode  :character    Mode  :character  
                                       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># orders</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(orders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [200 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ order_id    : chr [1:200] "OR8136" "OR4490" "OR5487" "OR5142" ...
 $ customer_id : chr [1:200] "CU3705" "CU5023" "CU8051" "CU6553" ...
 $ order_date  : chr [1:200] "2023-12-06" "2023-09-06" "2023-09-24" "2023-09-12" ...
 $ order_status: chr [1:200] "Pending" "Pending" "Processing" "Succeed" ...
 - attr(*, "spec")=
  .. cols(
  ..   order_id = col_character(),
  ..   customer_id = col_character(),
  ..   order_date = col_character(),
  ..   order_status = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>orders<span class="sc">$</span>order_status <span class="ot">=</span> <span class="fu">as.factor</span>(orders<span class="sc">$</span>order_status)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(orders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [200 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ order_id    : chr [1:200] "OR8136" "OR4490" "OR5487" "OR5142" ...
 $ customer_id : chr [1:200] "CU3705" "CU5023" "CU8051" "CU6553" ...
 $ order_date  : chr [1:200] "2023-12-06" "2023-09-06" "2023-09-24" "2023-09-12" ...
 $ order_status: Factor w/ 4 levels "Cancelled","Pending",..: 2 2 3 4 3 3 3 4 2 2 ...
 - attr(*, "spec")=
  .. cols(
  ..   order_id = col_character(),
  ..   customer_id = col_character(),
  ..   order_date = col_character(),
  ..   order_status = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   order_id         customer_id         order_date            order_status
 Length:200         Length:200         Length:200         Cancelled :52   
 Class :character   Class :character   Class :character   Pending   :50   
 Mode  :character   Mode  :character   Mode  :character   Processing:52   
                                                          Succeed   :46   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># orders_Details</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(orders_details)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [1,111 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ order_detail_id: chr [1:1111] "OD8508" "OD7044" "OD7465" "OD8159" ...
 $ order_id       : chr [1:1111] "OR8136" "OR4490" "OR5487" "OR5487" ...
 $ product_id     : chr [1:1111] "PR7365" "PR8045" "PR2068" "PR4512" ...
 $ sub_quantity   : num [1:1111] 1 4 4 3 1 2 9 1 10 1 ...
 - attr(*, "spec")=
  .. cols(
  ..   order_detail_id = col_character(),
  ..   order_id = col_character(),
  ..   product_id = col_character(),
  ..   sub_quantity = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orders_details)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> order_detail_id      order_id          product_id         sub_quantity   
 Length:1111        Length:1111        Length:1111        Min.   : 1.000  
 Class :character   Class :character   Class :character   1st Qu.: 3.000  
 Mode  :character   Mode  :character   Mode  :character   Median : 6.000  
                                                          Mean   : 5.465  
                                                          3rd Qu.: 8.000  
                                                          Max.   :10.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Product</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(product)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [500 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ product_id         : chr [1:500] "PR8894" "PR3108" "PR0267" "PR0122" ...
 $ category_id        : chr [1:500] "CT1002-623" "CT1001-103" "CT1004-771" "CT1001-865" ...
 $ product_name       : chr [1:500] "Gaming Laptop" "Trench Coat" "Dining Set" "Summer Dress" ...
 $ product_price      : num [1:500] 396 1582 3071 3187 2979 ...
 $ discount_percentage: num [1:500] 0.03 0.98 0.2 0.37 0.76 0.87 0.04 0.77 0.66 0.72 ...
 $ rate_value         : num [1:500] 4.6 2.2 5 1.2 3.3 2.5 2.6 1.9 4.3 2.7 ...
 - attr(*, "spec")=
  .. cols(
  ..   product_id = col_character(),
  ..   category_id = col_character(),
  ..   product_name = col_character(),
  ..   product_price = col_double(),
  ..   discount_percentage = col_double(),
  ..   rate_value = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(product)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  product_id        category_id        product_name       product_price    
 Length:500         Length:500         Length:500         Min.   :  30.25  
 Class :character   Class :character   Class :character   1st Qu.:1305.07  
 Mode  :character   Mode  :character   Mode  :character   Median :2420.86  
                                                          Mean   :2479.27  
                                                          3rd Qu.:3697.51  
                                                          Max.   :4997.68  
 discount_percentage   rate_value   
 Min.   :0.0000      Min.   :1.000  
 1st Qu.:0.2200      1st Qu.:2.100  
 Median :0.5000      Median :3.100  
 Mean   :0.5013      Mean   :3.058  
 3rd Qu.:0.7600      3rd Qu.:4.100  
 Max.   :0.9900      Max.   :5.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supplier</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(supplier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [80 × 8] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ supplier_id      : chr [1:80] "SU0454" "SU3047" "SU2545" "SU3336" ...
 $ supplier_name    : chr [1:80] "Keller Ltd" "Green-Duke" "Carey-Wilson" "Wilson and Sons" ...
 $ supplier_email   : chr [1:80] "briannatorres@example.org" "beasleydanielle@example.org" "frederickdanielle@example.org" "qlowe@example.org" ...
 $ supplier_zip_code: chr [1:80] "51142" "61509" "76466" "93041" ...
 $ supplier_country : chr [1:80] "Montenegro" "Mexico" "Cameroon" "North Macedonia" ...
 $ supplier_state   : chr [1:80] "New Mexico" "Illinois" "California" "Maryland" ...
 $ supplier_city    : chr [1:80] "Lake Amandachester" "West Troyburgh" "Nicoleborough" "Fergusonstad" ...
 $ supplier_street  : chr [1:80] "77637 Wolf Valleys" "19501 Pamela Grove" "7521 Kirk Summit Suite 712" "486 Zachary Gateway Apt. 277" ...
 - attr(*, "spec")=
  .. cols(
  ..   supplier_id = col_character(),
  ..   supplier_name = col_character(),
  ..   supplier_email = col_character(),
  ..   supplier_zip_code = col_character(),
  ..   supplier_country = col_character(),
  ..   supplier_state = col_character(),
  ..   supplier_city = col_character(),
  ..   supplier_street = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#supplier$supplier_phone = as.character(supplier$supplier_phone)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>supplier<span class="sc">$</span>supplier_country <span class="ot">=</span> <span class="fu">as.factor</span>(supplier<span class="sc">$</span>supplier_country)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>supplier<span class="sc">$</span>supplier_state <span class="ot">=</span> <span class="fu">as.factor</span>(supplier<span class="sc">$</span>supplier_state)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>supplier<span class="sc">$</span>supplier_city <span class="ot">=</span> <span class="fu">as.factor</span>(supplier<span class="sc">$</span>supplier_city)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(supplier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [80 × 8] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ supplier_id      : chr [1:80] "SU0454" "SU3047" "SU2545" "SU3336" ...
 $ supplier_name    : chr [1:80] "Keller Ltd" "Green-Duke" "Carey-Wilson" "Wilson and Sons" ...
 $ supplier_email   : chr [1:80] "briannatorres@example.org" "beasleydanielle@example.org" "frederickdanielle@example.org" "qlowe@example.org" ...
 $ supplier_zip_code: chr [1:80] "51142" "61509" "76466" "93041" ...
 $ supplier_country : Factor w/ 74 levels "Albania","American Samoa",..: 42 41 12 50 73 69 64 55 14 20 ...
 $ supplier_state   : Factor w/ 42 levels "Alabama","Alaska",..: 25 11 4 15 29 25 23 22 25 36 ...
 $ supplier_city    : Factor w/ 79 levels "Adammouth","Adamsshire",..: 28 79 44 14 7 61 52 71 19 43 ...
 $ supplier_street  : chr [1:80] "77637 Wolf Valleys" "19501 Pamela Grove" "7521 Kirk Summit Suite 712" "486 Zachary Gateway Apt. 277" ...
 - attr(*, "spec")=
  .. cols(
  ..   supplier_id = col_character(),
  ..   supplier_name = col_character(),
  ..   supplier_email = col_character(),
  ..   supplier_zip_code = col_character(),
  ..   supplier_country = col_character(),
  ..   supplier_state = col_character(),
  ..   supplier_city = col_character(),
  ..   supplier_street = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(supplier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> supplier_id        supplier_name      supplier_email     supplier_zip_code 
 Length:80          Length:80          Length:80          Length:80         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
   supplier_country    supplier_state       supplier_city supplier_street   
 Bahrain   : 2      Nevada    : 5     Riveraland   : 2    Length:80         
 Bermuda   : 2      Ohio      : 5     Adammouth    : 1    Class :character  
 India     : 2      California: 4     Adamsshire   : 1    Mode  :character  
 Montserrat: 2      New Mexico: 4     Andrewchester: 1                      
 Peru      : 2      Indiana   : 3     Andrewmouth  : 1                      
 Romania   : 2      Kentucky  : 3     Andrewsmouth : 1                      
 (Other)   :68      (Other)   :56     (Other)      :73                      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supply</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(supply)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [100 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ supply_id  : chr [1:100] "SP1667" "SP1197" "SP3947" "SP7219" ...
 $ supplier_id: chr [1:100] "SU2314" "SU2615" "SU6448" "SU6356" ...
 $ product_id : chr [1:100] "PR6800" "PR5180" "PR5183" "PR2265" ...
 $ stock      : num [1:100] 178 783 86 197 535 182 662 83 320 800 ...
 - attr(*, "spec")=
  .. cols(
  ..   supply_id = col_character(),
  ..   supplier_id = col_character(),
  ..   product_id = col_character(),
  ..   stock = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(supply)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  supply_id         supplier_id         product_id            stock      
 Length:100         Length:100         Length:100         Min.   :  4.0  
 Class :character   Class :character   Class :character   1st Qu.:231.5  
 Mode  :character   Mode  :character   Mode  :character   Median :522.0  
                                                          Mean   :509.1  
                                                          3rd Qu.:805.8  
                                                          Max.   :998.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transaction</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(transaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [46 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ transaction_id    : chr [1:46] "TR3416" "TR7104" "TR2501" "TR5378" ...
 $ order_id          : chr [1:46] "OR5142" "OR0737" "OR2802" "OR5005" ...
 $ customer_id       : chr [1:46] "CU6553" "CU0214" "CU5515" "CU1936" ...
 $ transaction_time  : chr [1:46] "2023-09-12 05:21:09" "2024-02-13 21:08:31" "2024-02-18 03:50:27" "2024-02-21 01:15:03" ...
 $ payment_method    : chr [1:46] "Debit Card" "PayPal" "Debit Card" "Credit Card" ...
 $ transaction_status: chr [1:46] "Succeed" "Pending" "Processing" "Succeed" ...
 - attr(*, "spec")=
  .. cols(
  ..   transaction_id = col_character(),
  ..   order_id = col_character(),
  ..   customer_id = col_character(),
  ..   transaction_time = col_character(),
  ..   payment_method = col_character(),
  ..   transaction_status = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform transaction_time without the float</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>transaction<span class="sc">$</span>transaction_time <span class="ot">=</span> <span class="fu">sub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">..*"</span>, <span class="st">""</span>, transaction<span class="sc">$</span>transaction_time)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>transaction<span class="sc">$</span>payment_method <span class="ot">=</span> <span class="fu">as_factor</span>(transaction<span class="sc">$</span>payment_method)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>transaction<span class="sc">$</span>transaction_status <span class="ot">=</span> <span class="fu">as_factor</span>(transaction<span class="sc">$</span>transaction_status)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(transaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [46 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ transaction_id    : chr [1:46] "TR3416" "TR7104" "TR2501" "TR5378" ...
 $ order_id          : chr [1:46] "OR5142" "OR0737" "OR2802" "OR5005" ...
 $ customer_id       : chr [1:46] "CU6553" "CU0214" "CU5515" "CU1936" ...
 $ transaction_time  : chr [1:46] "2023-09-12 05:21:09" "2024-02-13 21:08:31" "2024-02-18 03:50:27" "2024-02-21 01:15:03" ...
 $ payment_method    : Factor w/ 3 levels "Debit Card","PayPal",..: 1 2 1 3 2 3 2 3 1 3 ...
 $ transaction_status: Factor w/ 4 levels "Succeed","Pending",..: 1 2 3 1 3 4 2 3 2 1 ...
 - attr(*, "spec")=
  .. cols(
  ..   transaction_id = col_character(),
  ..   order_id = col_character(),
  ..   customer_id = col_character(),
  ..   transaction_time = col_character(),
  ..   payment_method = col_character(),
  ..   transaction_status = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(transaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> transaction_id       order_id         customer_id        transaction_time  
 Length:46          Length:46          Length:46          Length:46         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
     payment_method  transaction_status
 Debit Card :12     Succeed   :10      
 PayPal     :15     Pending   :11      
 Credit Card:19     Processing:13      
                    Failed    :12      </code></pre>
</div>
</div>
</section>
<section id="write-them-to-the-database" class="level2">
<h2 class="anchored" data-anchor-id="write-them-to-the-database">Write them to the database</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"ads"</span>,ads,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"category"</span>,category,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"customer_address"</span>,customer_address,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"customer"</span>,customer,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"delivery"</span>,delivery,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"orders"</span>,orders,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"orders_details"</span>,orders_details,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"product"</span>,product,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"supplier"</span>,supplier,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"supply"</span>,supply,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>RSQLite<span class="sc">::</span><span class="fu">dbWriteTable</span>(my_connection,<span class="st">"transaction"</span>,transaction,<span class="at">append =</span> <span class="cn">TRUE</span>,<span class="at">overwrite=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="database-check" class="level2">
<h2 class="anchored" data-anchor-id="database-check">Database check</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tables check to see if there's any error in the data import stage</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ads_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"ads"</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>ads_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;ads&gt; [?? x 5]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   ad_id  product_id ad_status ad_start_date ad_end_date
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;      
 1 AD3411 PR5955     active    2023-09-04    2024-04-26 
 2 AD5591 PR2980     active    2023-12-04    2025-01-07 
 3 AD2023 PR4455     active    2023-06-18    2024-04-13 
 4 AD2393 PR9243     ended     2023-08-04    2023-09-09 
 5 AD4876 PR9370     active    2023-11-08    2025-12-09 
 6 AD7559 PR2975     ended     2023-07-21    2023-11-01 
 7 AD4058 PR0573     active    2023-11-07    2024-05-10 
 8 AD3208 PR6085     active    2023-07-20    2025-07-15 
 9 AD8869 PR3912     active    2022-10-21    2025-02-22 
10 AD4780 PR2619     ended     2023-06-08    2023-10-19 
# ℹ more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>category_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"category"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>category_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;category&gt; [?? x 3]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   category_id category_name parent_category_id
   &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;             
 1 CT1001      Clothing      &lt;NA&gt;              
 2 CT1001-208  Shirts        CT1001            
 3 CT1001-546  Pants         CT1001            
 4 CT1001-865  Dresses       CT1001            
 5 CT1001-103  Outerwear     CT1001            
 6 CT1002      Electronics   &lt;NA&gt;              
 7 CT1002-150  Smartphones   CT1002            
 8 CT1002-623  Laptops       CT1002            
 9 CT1002-942  Cameras       CT1002            
10 CT1002-517  Accessories   CT1002            
# ℹ more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>customer_address_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"customer_address"</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>customer_address_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;customer_address&gt; [?? x 7]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   customer_address_id customer_id zip_code country           state city  street
   &lt;chr&gt;               &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;             &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 
 1 CA8785              CU3320      21639    Greece            Ariz… East… 76218…
 2 CA6746              CU3320      86282    Bosnia and Herze… Nebr… East… 2956 …
 3 CA4295              CU3320      57281    Jersey            Wash… New … 7829 …
 4 CA2484              CU8307      30961    Luxembourg        West… Nort… 6383 …
 5 CA3686              CU8307      10724    Somalia           Loui… Anna… 93301…
 6 CA4009              CU0170      09807    Colombia          New … Will… 70245…
 7 CA3795              CU0170      63393    Guernsey          Miss… East… 811 D…
 8 CA9475              CU2873      20237    Christmas Island  Kans… Lake… 728 J…
 9 CA3216              CU2873      49246    Honduras          Hawa… Vict… 603 P…
10 CA2646              CU2873      58802    Sri Lanka         Virg… Tara… 7030 …
# ℹ more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>customer_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"customer"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>customer_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;customer&gt; [?? x 8]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   customer_id first_name last_name gender date_of_birth email     password_hash
   &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;        
 1 CU3320      Brian      Miller    female 1962-12-09    roberson… 429b5dfe28a2…
 2 CU8307      Martin     Christian male   1944-11-12    ann32@ex… da7e994ae66d…
 3 CU0170      Kim        Johns     female 1960-10-09    stewarts… 18c5bd20707f…
 4 CU2873      Douglas    Tyler     female 1934-10-05    qberry@e… 013f9b5037a0…
 5 CU8659      Kayla      Cooper    male   1991-09-20    lorifowl… dbfc8b180869…
 6 CU8645      Leslie     Sanders   other  1989-05-14    ocohen@e… 57de529ffd54…
 7 CU5458      Martha     Meyer     other  1963-11-01    boonedeb… 8a2bea3e41bd…
 8 CU7042      Robin      Barrett   female 1945-08-18    angela17… 6c89b3eb29e3…
 9 CU5873      Matthew    Lopez     female 1939-08-24    alexande… 1e88c47a5ff5…
10 CU1060      Jennifer   Stout     female 1979-11-04    omaynard… e9f3bb2ded40…
# ℹ more rows
# ℹ 1 more variable: membership &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>delivery_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"delivery"</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>delivery_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;delivery&gt; [10 x 6]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   delivery_id transaction_id customer_address_id delivery_status
   &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;               &lt;chr&gt;          
 1 DE9143      TR3416         CA7294              In_Delivery    
 2 DE9770      TR5378         CA9915              Completed      
 3 DE1870      TR4534         CA2167              Failed         
 4 DE4792      TR8649         CA9655              Completed      
 5 DE0758      TR1303         CA7441              In_Delivery    
 6 DE1130      TR5157         CA5519              Not_Delivered  
 7 DE3289      TR0380         CA5726              Not_Delivered  
 8 DE1336      TR6304         CA9080              Completed      
 9 DE1135      TR8050         CA6293              Failed         
10 DE6760      TR4632         CA0338              Completed      
# ℹ 2 more variables: delivery_start_date &lt;chr&gt;, delivery_end_date &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>orders_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"orders"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>orders_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;orders&gt; [?? x 4]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   order_id customer_id order_date order_status
   &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;       
 1 OR8136   CU3705      2023-12-06 Pending     
 2 OR4490   CU5023      2023-09-06 Pending     
 3 OR5487   CU8051      2023-09-24 Processing  
 4 OR5142   CU6553      2023-09-12 Succeed     
 5 OR9845   CU3737      2023-11-05 Processing  
 6 OR0940   CU5873      2023-12-30 Processing  
 7 OR3870   CU0352      2024-02-13 Processing  
 8 OR0737   CU0214      2024-02-13 Succeed     
 9 OR9861   CU7908      2024-02-08 Pending     
10 OR8203   CU3205      2024-02-15 Pending     
# ℹ more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>orders_details_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"orders_details"</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>orders_details_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;orders_details&gt; [?? x 4]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   order_detail_id order_id product_id sub_quantity
   &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;             &lt;dbl&gt;
 1 OD8508          OR8136   PR7365                1
 2 OD7044          OR4490   PR8045                4
 3 OD7465          OR5487   PR2068                4
 4 OD8159          OR5487   PR4512                3
 5 OD3780          OR5487   PR2654                1
 6 OD7705          OR5487   PR9602                2
 7 OD2209          OR5487   PR4947                9
 8 OD8482          OR5487   PR4104                1
 9 OD6555          OR5487   PR4994               10
10 OD4201          OR5142   PR5470                1
# ℹ more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>product_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"product"</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>product_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;product&gt; [?? x 6]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   product_id category_id product_name         product_price discount_percentage
   &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;                        &lt;dbl&gt;               &lt;dbl&gt;
 1 PR8894     CT1002-623  Gaming Laptop                 396.                0.03
 2 PR3108     CT1001-103  Trench Coat                  1582.                0.98
 3 PR0267     CT1004-771  Dining Set                   3071.                0.2 
 4 PR0122     CT1001-865  Summer Dress                 3187.                0.37
 5 PR7884     CT1003-935  Historical Biography         2979.                0.76
 6 PR1733     CT1003-799  Mathematics Textbook         1969.                0.87
 7 PR2275     CT1002-623  Ultrabook                     603.                0.04
 8 PR5132     CT1003-799  Language Workbook            2493.                0.77
 9 PR8387     CT1001-103  Windbreaker                  3093.                0.66
10 PR8525     CT1002-623  Ultrabook                    1165.                0.72
# ℹ more rows
# ℹ 1 more variable: rate_value &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>supplier_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"supplier"</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>supplier_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;supplier&gt; [?? x 8]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   supplier_id supplier_name   supplier_email supplier_zip_code supplier_country
   &lt;chr&gt;       &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;             &lt;chr&gt;           
 1 SU0454      Keller Ltd      briannatorres… 51142             Montenegro      
 2 SU3047      Green-Duke      beasleydaniel… 61509             Mexico          
 3 SU2545      Carey-Wilson    frederickdani… 76466             Cameroon        
 4 SU3336      Wilson and Sons qlowe@example… 93041             North Macedonia 
 5 SU7830      Greer, Willis … melissa83@exa… 31787             Wallis and Futu…
 6 SU5534      Wheeler, David… andersonheath… 14634             United States o…
 7 SU5030      Rodriguez, Cra… stokessarah@e… 96994             Tonga           
 8 SU4734      Carey Group     dgardner@exam… 20836             Romania         
 9 SU2738      Ray PLC         john61@exampl… 46284             Central African…
10 SU4246      Ayers and Sons  andrewfrankli… 39617             Djibouti        
# ℹ more rows
# ℹ 3 more variables: supplier_state &lt;chr&gt;, supplier_city &lt;chr&gt;,
#   supplier_street &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>supply_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"supply"</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>supply_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;supply&gt; [?? x 4]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   supply_id supplier_id product_id stock
   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;
 1 SP1667    SU2314      PR6800       178
 2 SP1197    SU2615      PR5180       783
 3 SP3947    SU6448      PR5183        86
 4 SP7219    SU6356      PR2265       197
 5 SP1187    SU8172      PR9807       535
 6 SP7378    SU4069      PR5026       182
 7 SP9899    SU7168      PR2927       662
 8 SP3207    SU2961      PR5026        83
 9 SP6177    SU0300      PR9839       320
10 SP4112    SU3311      PR2068       800
# ℹ more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>transaction_check <span class="ot">=</span> <span class="fu">tbl</span>(my_connection, <span class="st">"transaction"</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>transaction_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;transaction&gt; [?? x 6]
# Database: sqlite 3.45.0 [/cloud/project/database/an_e_commerce.db]
   transaction_id order_id customer_id transaction_time    payment_method
   &lt;chr&gt;          &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;               &lt;chr&gt;         
 1 TR3416         OR5142   CU6553      2023-09-12 05:21:09 Debit Card    
 2 TR7104         OR0737   CU0214      2024-02-13 21:08:31 PayPal        
 3 TR2501         OR2802   CU5515      2024-02-18 03:50:27 Debit Card    
 4 TR5378         OR5005   CU1936      2024-02-21 01:15:03 Credit Card   
 5 TR0480         OR4723   CU3812      2023-12-01 07:04:50 PayPal        
 6 TR8780         OR6113   CU1607      2023-12-07 09:40:14 Credit Card   
 7 TR3405         OR4918   CU4580      2024-01-21 09:04:35 PayPal        
 8 TR0583         OR5176   CU1936      2024-02-17 23:53:51 Credit Card   
 9 TR5010         OR8263   CU0298      2024-01-06 04:53:56 Debit Card    
10 TR4534         OR6259   CU3737      2023-11-18 23:02:47 Credit Card   
# ℹ more rows
# ℹ 1 more variable: transaction_status &lt;chr&gt;</code></pre>
</div>
</div>
<p>It seems no data structure errors in this stage.</p>
<hr>
</section>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<section id="product-popularity" class="level2">
<h2 class="anchored" data-anchor-id="product-popularity">1 Product Popularity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query to count the frequency of each product_id and retrieve top 10 popular products</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>top_10_popular_products <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT p.product_name, </span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="st">         SUM(od.sub_quantity) AS Frequency</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM orders_details od</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN product p ON od.product_id = p.product_id</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY od.product_id, p.product_name</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY Frequency DESC</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="st">  LIMIT 10</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bar chart of the top 10 popular products with product names on the x-axis</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_10_popular_products, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(product_name, <span class="sc">-</span>Frequency), <span class="at">y =</span> Frequency)) <span class="sc">+</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#6495ED"</span>) <span class="sc">+</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Frequency), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Add numeric labels on top of bars</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Popular Products"</span>,</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Product Name"</span>,</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Amount Consumed"</span>) <span class="sc">+</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Gaming laptops, screwdriver sets and polo shirts are the top 3 popular products with more than 40 units per product being sold.</p>
</section>
<section id="product-sales-analysis" class="level2">
<h2 class="anchored" data-anchor-id="product-sales-analysis">2 Product Sales Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query to calculate total revenue for each product and retrieve top 10 products</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>product_total_revenue <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT product.product_id, </span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="st">         product.product_name,</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="st">         SUM(CASE </span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="st">               WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="st">               ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="st">             END) AS total_revenue</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM orders_details</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN product ON orders_details.product_id = product.product_id</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN orders ON orders_details.order_id = orders.order_id</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY product.product_id</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY total_revenue DESC</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="st">  LIMIT 10</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the ggplot for total revenue with product names on the x-axis</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(product_total_revenue, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(product_name, <span class="fu">desc</span>(total_revenue)), <span class="at">y =</span> total_revenue)) <span class="sc">+</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#6495ED"</span>) <span class="sc">+</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Sales Figures for Top 10 Products"</span>,</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Product Name"</span>,</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Sales"</span>) <span class="sc">+</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(product_total_revenue<span class="sc">$</span>total_revenue), <span class="at">by =</span> <span class="dv">25000</span>)) <span class="sc">+</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>screw driver sets, Plant pots and bookshelves are the top 3 products that have the most sales, and all top 10 products have more than 100,000 sales which is considerably a great amount of sales. top 10 products are from all categories except the Electronics category. Which makes sense as Electronics will not have a high amount of sales.</p>
</section>
<section id="category-sales-popularity-analysis" class="level2">
<h2 class="anchored" data-anchor-id="category-sales-popularity-analysis">3 Category Sales &amp; Popularity Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Category Popularity</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>category_popularity <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT SUBSTRING(product.category_id, 1, 6) AS category,</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="st">       SUM(orders_details.sub_quantity) AS total_quantity,</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="st">       category.category_name</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM product</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders_details ON product.product_id = orders_details.product_id</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN category ON SUBSTRING(product.category_id, 1, 6) = category.category_id</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY SUBSTRING(product.category_id, 1, 6), category.category_name</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Category Sales</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>category_sales <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT SUBSTRING(product.category_id, 1, 6) AS category,</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="st">       SUM(CASE</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="st">               WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="st">               ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="st">           END) AS total_sales,</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="st">       category.category_name</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a><span class="st">FROM product</span></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders_details ON product.product_id = orders_details.product_id</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders ON orders_details.order_id = orders.order_id</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN category ON SUBSTRING(product.category_id, 1, 6) = category.category_id</span></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY SUBSTRING(product.category_id, 1, 6), category.category_name</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine category sales and category popularity data, removing duplicate category_name column</span></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(category_sales, category_popularity <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>category_name), <span class="at">by =</span> <span class="st">"category"</span>)</span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> category_name)) <span class="sc">+</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_sales), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#6495ED"</span>) <span class="sc">+</span>  <span class="co"># Bar plot representing category sales</span></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_quantity <span class="sc">*</span> <span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">group =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Line plot representing category popularity, multiplied by 1000 just for demonstration of comparison on the same plot</span></span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Total Sales"</span>, <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>, <span class="at">name =</span> <span class="st">"Popularity"</span>)) <span class="sc">+</span>  <span class="co"># Set dual y-axes, representing sales and popularity</span></span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Category Sales and Popularity Analysis"</span>,</span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Category"</span>, <span class="at">y =</span> <span class="st">"Total Sales"</span>,) <span class="sc">+</span></span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The above graph depicts in terms of popularity of categories and total sales.It can be seen that Home &amp; Garden and Toys &amp; Games categories have the highest amount of sales more than 200,000 and electronics have the lowest amount which is again understandable as Electronics generally do not have&nbsp;a&nbsp;lot&nbsp;of&nbsp;sales</p>
</section>
<section id="gender-category-visualization" class="level2">
<h2 class="anchored" data-anchor-id="gender-category-visualization">4 Gender &amp; Category Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query in R</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>category_gender_sales <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT SUBSTRING(product.category_id, 1, 6) AS category,</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="st">       customer.gender,</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="st">       SUM(CASE</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="st">               WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="st">               ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="st">           END) AS total_sales,</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="st">       category.category_name</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="st">FROM product</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders_details ON product.product_id = orders_details.product_id</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders ON orders_details.order_id = orders.order_id</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN category ON SUBSTRING(product.category_id, 1, 6) = category.category_id</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY SUBSTRING(product.category_id, 1, 6), category.category_name, customer.gender</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot gender-category sales relationship</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(category_gender_sales, <span class="fu">aes</span>(<span class="at">x =</span> category_name, <span class="at">y =</span> total_sales, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Gender &amp; Category Sales Analysis"</span>,</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Category Name"</span>,</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Sales"</span>,</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Gender"</span>) <span class="sc">+</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The above graph depicts that in general all genders equally buy Home &amp; Garden products but there is a clear difference in gender differences for other categories. For clothing there are more sales to females and Electronics, Games &amp; Toys are more sold to boys. For Books there is somewhat an equal amount of sales to both boys and girls. Along with this, Figure13 represents the density of users are more after 55 years of age suggesting that most of the users of the website are senior citizens and not much sales are done for users who are young and middle aged. This suggests that more marketing and advertisements have to be run for these&nbsp;age&nbsp;groups.</p>
</section>
<section id="age-visualization" class="level2">
<h2 class="anchored" data-anchor-id="age-visualization">5 Age Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>customer1 <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT customer.*,</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="st">  FLOOR((julianday('now') - julianday(customer.date_of_birth)) / 365.25) AS age1</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM customer"</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution of Age</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(customer1, <span class="fu">aes</span>(<span class="at">x =</span> age1)) <span class="sc">+</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">fill =</span> <span class="st">"#6495ED"</span>, <span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram and Density Plot of Age"</span>, <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(customer1<span class="sc">$</span>age1), <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The density of users are more after 55 years of age suggesting that most of the users of the website are senior citizens and not much sales are done for users who are young and middle aged. This suggests that more marketing and advertisements have to be run for these age groups.</p>
</section>
<section id="age-category-visualization-pass" class="level2">
<h2 class="anchored" data-anchor-id="age-category-visualization-pass">6 Age &amp; Category Visualization (pass)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query to get relevant data</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>customer_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT FLOOR((julianday('now') - julianday(customer.date_of_birth)) / 365.25) AS age,</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="st">         SUM(CASE</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="st">                 WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="st">                 ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="st">             END) AS total_sales,</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="st">         SUBSTRING(product.category_id, 1, 6) AS category,</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="st">         category.category_name</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM customer</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN orders ON customer.customer_id = orders.customer_id</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN orders_details ON orders.order_id = orders_details.order_id</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN product ON orders_details.product_id = product.product_id</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN category ON SUBSTRING(product.category_id, 1, 6) = category.category_id</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY age, customer.gender, category, category.category_name</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Define age groups with intervals of 10 years</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>customer_data<span class="sc">$</span>age_group <span class="ot">&lt;-</span> <span class="fu">cut</span>(customer_data<span class="sc">$</span>age, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(customer_data<span class="sc">$</span>age) <span class="sc">+</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">10</span>))</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Age &amp; Category Visualization</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(customer_data, <span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">y =</span> total_sales, <span class="at">fill =</span> category_name)) <span class="sc">+</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Sales by Age Group and Category"</span>,</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Sales"</span>,</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Category"</span>) <span class="sc">+</span></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The above graph depicts that although members are mostly senior citizens most 20-30 and 30-40 age group members have made the most amount of sales suggesting that although the amount of users are low they make high valued purchases. 10-20 and 40-50 aged customers have purchased products at the lowest value. Therefore we can do more marketing to them to increase sales</p>
</section>
<section id="region-revenue-analysis" class="level2">
<h2 class="anchored" data-anchor-id="region-revenue-analysis">7 Region Revenue Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query to calculate total revenue for each state</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>state_total_revenue <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT customer_address.state, </span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="st">         SUM(</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="st">           CASE </span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="st">             WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="st">             ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="st">           END</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="st">         ) AS total_revenue</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM orders</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN orders_details ON orders.order_id = orders_details.order_id</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN product ON orders_details.product_id = product.product_id</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN customer_address ON customer.customer_id = customer_address.customer_id</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY customer_address.state</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the top 10 states by total revenue</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>top_10_state_total_revenue <span class="ot">&lt;-</span> state_total_revenue <span class="sc">%&gt;%</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_revenue)) <span class="sc">%&gt;%</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the total revenue for the top 10 states</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_10_state_total_revenue, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(state, <span class="sc">-</span>total_revenue), <span class="at">y =</span> total_revenue)) <span class="sc">+</span> </span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#6495ED"</span>) <span class="sc">+</span></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 States by Total Consumption"</span>,</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"State"</span>,</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Consumption"</span>) <span class="sc">+</span></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(top_10_state_total_revenue<span class="sc">$</span>total_revenue), <span class="at">by =</span> <span class="dv">250000</span>)) <span class="sc">+</span></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>The above graph shows that Colarado has the most amount of sales and Idaho has the lowest amount of sales however it is still at a considerable level as all sales are above 750,000 However we can try to increase more sales in Idaho by doing more promotion for users in that particular&nbsp;region</p>
</section>
</section>
<section id="time-analysis" class="level1">
<h1>Time Analysis</h1>
<section id="total-order-value-trend-analysis" class="level2">
<h2 class="anchored" data-anchor-id="total-order-value-trend-analysis">8 Total Order Value Trend Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Order_Date to month-year format directly in SQL and calculate total order value per month</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>total_order_value_by_month <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT strftime('%Y-%m', orders.order_date) AS month_year,</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="st">         SUM(</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="st">           CASE </span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="st">             WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="st">             ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="st">           END</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="st">         ) AS total_order_value</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM orders</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN orders_details ON orders.order_id = orders_details.order_id</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN product ON orders_details.product_id = product.product_id</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY month_year</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the trend of total order value over time</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_order_value_by_month, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(month_year, <span class="st">"-01"</span>), <span class="st">"%Y-%m-%d"</span>), <span class="at">y =</span> total_order_value, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#6495ED"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of Total Order Value Over Time"</span>,</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Order Value"</span>) <span class="sc">+</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span>  <span class="co"># Adjust y-axis labels to use dollar formatting</span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">"%b %Y"</span>)) <span class="sc">+</span>  <span class="co"># Format x-axis labels as Sep 2023</span></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove legend to avoid redundancy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>the graph shows the total sales from all orders for each month. The figure increases considerably between October and December 2023, reaching a peak in December, followed by a rapid decrease in the next month.</p>
</section>
<section id="average-order-value-trend-analysis" class="level2">
<h2 class="anchored" data-anchor-id="average-order-value-trend-analysis">9 Average Order Value Trend Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Order_Date to month-year format directly in SQL and calculate average order value per month</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>average_order_value_by_month <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT strftime('%Y-%m', orders.order_date) AS month_year,</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="st">         AVG(</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="st">           CASE </span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="st">             WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="st">             ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="st">           END</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="st">         ) AS average_order_value</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM orders</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN orders_details ON orders.order_id = orders_details.order_id</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN product ON orders_details.product_id = product.product_id</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY month_year</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the trend of average order value over time</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(average_order_value_by_month, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(month_year, <span class="st">"-01"</span>), <span class="st">"%Y-%m-%d"</span>), <span class="at">y =</span> average_order_value, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#6495ED"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of Average Order Value Over Time"</span>,</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Order Value"</span>) <span class="sc">+</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span>  <span class="co"># Adjust y-axis labels to use dollar formatting</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">"%b %Y"</span>)) <span class="sc">+</span>  <span class="co"># Format x-axis labels as Sep 2023</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove legend to avoid redundancy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This graph illustrates the average sales value of all orders for each month. There is a significant increase between October and November 2023, while the average sales drop dramatically from January to February 2024</p>
</section>
<section id="category-sales-trend-analysis" class="level2">
<h2 class="anchored" data-anchor-id="category-sales-trend-analysis">10 Category Sales Trend Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query in R</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>category_sales_time <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT strftime('%Y-%m', orders.order_date) AS category_month_year,</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="st">       SUBSTRING(product.category_id, 1, 6) AS category,</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="st">       SUM(CASE</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="st">               WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="st">               ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="st">           END) AS total_sales,</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="st">       category.category_name</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="st">FROM product</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders_details ON product.product_id = orders_details.product_id</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders ON orders_details.order_id = orders.order_id</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN category ON SUBSTRING(product.category_id, 1, 6) = category.category_id</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY strftime('%Y-%m', orders.order_date), SUBSTRING(product.category_id, 1, 6), category.category_name</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert category_month_year to Date format</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>category_sales_time<span class="sc">$</span>category_month_year <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(category_sales_time<span class="sc">$</span>category_month_year, <span class="st">"-01"</span>))</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the line chart of category sales over time for the five main categories</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(category_sales_time, <span class="fu">aes</span>(<span class="at">x =</span> category_month_year, <span class="at">y =</span> total_sales, <span class="at">color =</span> category_name)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Category Sales Analysis Over Time"</span>,</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Sales"</span>,</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Category Name"</span>) <span class="sc">+</span></span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The above graph depicts the trend in total consumption with and without membership for each month.&nbsp;</p>
<p>It is apparent that the total consumption for non-members surpasses that of members throughout the entire period, which is counterintuitive. While the consumption trend closely resembles that depicted in Figure 16, the figures for members reached a peak in November 2023.&nbsp;&nbsp;</p>
<p>According to the sales analysis, over time Home &amp; Garden and Electronics sales have met with a sharp decline from January to February. But all categories of books, clothing, electronics, Home &amp; Garden and Toys &amp; Games have had a steady increase from September 2023 to December 2023 suggesting that the products sold through the website are in demand and preferred by customers. The decline from December to January could be because of the year end and most sales happening during the Christmas and new year time for seasonal changes. However, books, clothing and Toys &amp; Games have started to increase again, which suggests that sales will increase, and the company has nothing to worry about</p>
</section>
<section id="membership-revenue-trend-analysis" class="level2">
<h2 class="anchored" data-anchor-id="membership-revenue-trend-analysis">11 Membership Revenue Trend Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute SQL query in the database and fetch the results</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>membership_revenue_by_month <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT strftime('%Y-%m', orders.order_date) AS membership_month_year,</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="st">         customer.membership,</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="st">         SUM(CASE </span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="st">               WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="st">               ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="st">             END) AS total_revenue</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM orders</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN orders_details ON orders.order_id = orders_details.order_id</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN product ON orders_details.product_id = product.product_id</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY membership_month_year, customer.membership</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the date column to a date-time format</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>membership_revenue_by_month<span class="sc">$</span>membership_month_year <span class="ot">&lt;-</span> <span class="fu">ym</span>(membership_revenue_by_month<span class="sc">$</span>membership_month_year)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the trend of membership revenue over time</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(membership_revenue_by_month, <span class="fu">aes</span>(<span class="at">x =</span> membership_month_year, <span class="at">y =</span> total_revenue, <span class="at">group =</span> membership, <span class="at">color =</span> membership)) <span class="sc">+</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of Membership Consumption Over Time"</span>,</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Consumption"</span>,</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Membership Status"</span>) <span class="sc">+</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The above graph shows the trend in total consumption with and without membership for each month. It is apparent that the total consumption for non-members surpasses that of members throughout the entire period, which is counterintuitive. The figures for members reached a peak in November 2023.</p>
</section>
<section id="total-product-revenue-analysis-by-rate" class="level2">
<h2 class="anchored" data-anchor-id="total-product-revenue-analysis-by-rate">12 Total Product Revenue Analysis by Rate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Query to retrieve product revenue by rate category</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>product_revenue_by_rate <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(my_connection, <span class="st">"</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT strftime('%Y-%m', orders.order_date) AS product_month_year,</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="st">         SUM(</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="st">           CASE </span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="st">             WHEN customer.membership = 'yes' THEN orders_details.sub_quantity * product.product_price * product.discount_percentage</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="st">             ELSE orders_details.sub_quantity * product.product_price</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="st">           END</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="st">         ) AS total_revenue,</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="st">         CASE</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="st">           WHEN product.rate_value BETWEEN 1 AND 2 THEN '1-2'</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="st">           WHEN product.rate_value BETWEEN 2 AND 3 THEN '2-3'</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="st">           WHEN product.rate_value BETWEEN 3 AND 4 THEN '3-4'</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="st">           WHEN product.rate_value BETWEEN 4 AND 5 THEN '4-5'</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="st">           ELSE 'Unknown'</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="st">         END AS rate_category</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM orders_details</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN orders ON orders_details.order_id = orders.order_id</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN product ON orders_details.product_id = product.product_id</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN customer ON orders.customer_id = customer.customer_id</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY product_month_year, rate_category</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the date column to a date-time format</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>product_revenue_by_rate<span class="sc">$</span>product_month_year <span class="ot">&lt;-</span> <span class="fu">ym</span>(product_revenue_by_rate<span class="sc">$</span>product_month_year)</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the trend of product revenue by rate category over time</span></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(product_revenue_by_rate, <span class="fu">aes</span>(<span class="at">x =</span> product_month_year, <span class="at">y =</span> total_revenue, <span class="at">group =</span> rate_category, <span class="at">color =</span> rate_category)) <span class="sc">+</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Product Sales Trend by Rate Category Over Time"</span>,</span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Product Sales"</span>,</span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Rate Category"</span>) <span class="sc">+</span></span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DM-REPORT_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graph demonstrates the trend of total product sales categorized into four rate groups.&nbsp;</p>
<p>Product sales in all rate categories exhibit a similar trend to that of Figure 16. However, it appears that the total product sales for both the highest and lowest rate categories maintain similar figures throughout the entire period, except for last month.&nbsp;</p>
<p>It is seen that most of the rates have been given in the month of December where the greatest number of sales also happened. It could have been because of Christmas. It is questionable as the range of rates is quite mixed at 4-5 and 1-2, meaning we have made quality sales but also sales which are unsatisfactory. A further analysis has to be done to gauge for what products by which sellers have got the unsatisfactory rates and steps must be taken to rectify the quality to increase the rates.&nbsp;</p>
</section>
<section id="disconnect-from-the-database" class="level2">
<h2 class="anchored" data-anchor-id="disconnect-from-the-database">Disconnect from the database</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(my_connection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>